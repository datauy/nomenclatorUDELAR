<div id="map"></div>
<script>
const shadowUrl = "<%= image_path 'marker-shadow.png' %>";
const iconSVG = `
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="29" height="37" xmlns="http://www.w3.org/2000/svg">
    <g fill="none" fill-rule="evenodd">
        <ellipse fill-opacity=".5" fill="#000" fill-rule="nonzero" cx="14.5" cy="36" rx="3.5" ry="1"/>
        <path d="M14.464 0c7.988 0 14.464 6.215 14.464 13.882 0 .179-.006.36-.018.542.012.25.018.502.018.755 0 8.383-12.964 20.913-14.464 20.913S0 23.562 0 15.179c0-.253.006-.505.018-.755A8.537 8.537 0 0 1 0 13.882C0 6.215 6.476 0 14.464 0z" fill="#005598" fill-rule="nonzero"/>
        <path d="M14.067 11.75c.9.003 1.706.564 2.051 1.413l.06.163L19 22.1h-3.333V29h-3.334v-6.9H9l2.822-8.774c.284-.886 1.055-1.501 1.943-1.57l.168-.006h.134zm-.025 4.032a1.212 1.212 0 0 0-1.711.09l-.808.897a1.212 1.212 0 0 0 1.801 1.622l.808-.898a1.212 1.212 0 0 0-.09-1.711zm1.823-2.024c-.5-.45-1.261-.411-1.71.088-.45.5-.41 1.26.09 1.71.5.45 1.261.411 1.71-.088.45-.5.41-1.26-.09-1.71zM14.303 6c1.261 0 2.273 1.077 2.273 2.421 0 1.344-1.012 2.421-2.273 2.421-1.261 0-2.273-1.077-2.273-2.42C12.03 7.076 13.042 6 14.303 6z" fill="#FFF"/>
    </g>
</svg>
`;
//const iconDiv = iconSVG + '<img src="'+shadowUrl+'"></img>' ;

const iconDefault = L.divIcon({
  className: "salas-marker",
  // iconUrl: iconSVGUrl,
  html: iconSVG,
  shadowUrl,
  iconSize: [28, 38],
  iconAnchor: [14, 37],
  popupAnchor: [1, -34],
  tooltipAnchor: [16, -28],
  shadowSize: [41, 10],
  shadowAnchor: [14, -38]
});
L.Marker.prototype.options.icon = iconDefault;
$.getJSON("salas_de_lactancia_merged.geojson", function (salas) {
  this.animating = true;
  this.map = new L.Map("map", {minZoom:4}).setView([-11.336196, -63.605775], 4);
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
  }).addTo(this.map);
  L.geoJSON(salas).addTo(this.map);
  var mapBounds = [];
  salas.features.forEach((feature) => {
    mapBounds.push(feature.geometry.coordinates.slice(0,2).reverse())
  })
  this.map.flyToBounds(mapBounds);
} );
</script>
